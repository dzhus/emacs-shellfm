-*-org-*-

* Dev notes
** Package structure
   A package provides Emacs Lisp interface to control shell-fm (console
   Last.fm player) subprocess
** User functions
   Sending commands to shell-fm subprocess.
** DONE [#A] Parsing shell-fm output
   CLOSED: [2008-01-05 Сбт 23:20]
   Filter function should inform user about shell-fm status
** [100%] «Robustness» :-)
   - [1/1] Handle unexpected shell-fm output
     - [X] Unset login/password
   - [X] Unset Last.fm username
         Emacs-shellfm extracts account name from `shell-fm.rc` which
         is guaranteed to be correct as `shell-fm(1)` uses this data
         to connect to the Last.fm servers
** TODO Keybindings
** [1/2] «Nifties»
   - [ ] modeline lighter
   - [X] rich format status messages
** DONE Shell.FM global menu
** TODO [#D] Minor mode
   Probably emacs-shellfm should act like a minor mode.
   [[info:elisp:Minor%20Mode%20Conventions][elisp:Minor Mode Conventions]]
** TODO Nondefault `np-file-format` value handling
   Currently emacs-shellfm is unaware of `np-file-format` changes in
   `shell-fm.rc`.

   Probably the package should somehow get all available track
   information, mapping `shell-fm(1)` output into elisp variables for
   further processing and using (i. e. in `shellfm-track-info`
   function). Ways to achieve this are:

   1. Use network interface `info` command. Cons: second interaction
      level in addition to subprocess textual exchange.
   2. Override `np-file-format` option when launching `shell-fm(1)` to
      "%a;%t;%l%d;%s;%R".
** Package functions
** TODO [13/13] General
   - [X] shellfm
   - [X] shellfm-url
   - [X] shellfm-station-tag
   - [X] Autocomplete global tags
   - [X] shellfm-station-artist
   - [X] Autocomplete favorite artists
   - [X] shellfm-station-recommended
   - [X] shellfm-station-group
   - [X] shellfm-station-fans
   - [X] shellfm-station-similar-artists
   - [X] shellfm-station-playlist
   - [X] shellfm-kill
   - [X] shellfm-status
** TODO [94%] Current track operation
   - [X] shellfm-track-info
   - [ ] Album data in track info
   - [X] shellfm-skip-track
   - [X] shellfm-love-track
   - [X] shellfm-ban-track
   - [5/5] Tagging
     - [X] shellfm-tag
     - [X] shellfm-tag-track
     - [X] shellfm-tag-artist
     - [X] shellfm-tag-album
     - [X] autocomplete tags while tagging
   - [4/4] Recommending
     - [X] shellfm-recommend
     - [X] shellfm-recommend-track
     - [X] shellfm-recommend-artist
     - [X] shellfm-recommend-album
   - [X] shellfm-similar-artists
   - [X] shellfm-pause
   - [X] shellfm-stop
   - [X] shellfm-add-to-playlist
** Customizable options
** IN PROGRESS [4/5] General
   - [X] shellfm-executable
   - [X] shellfm-args
   - [X] shellfm-track-hook
   - [X] shellfm-status-hook
   - [ ] shellfm-global-menu
** Issues
** DONE getopt+shell-fm is nasty with command line options:
   CLOSED: [2008-01-04 Птн 19:29]
   `shell-fm -b ""` — yields «Bad lastfm:// URL» error. Fix: always
   pass some `lastfm://` URL to `shell-fm` process. 

* Manual
** Prerequisites
   Make sure you've got fresh Shell-fm *working* installation (checked
   with git version 24-06-2008).
** Installation
   Unpack emacs-shellfm tarball.

   Type `make recompile` to byte-compile `.el` files.

   Add the following to your `~/.emacs.el` file:

       (add-to-list 'load-path "/path/to/emacs-shellfm/directory")
       (require 'shellfm)

   Reload your `~/.emacs.el`. Customize `shellfm` options group.
** Using emacs-shellfm
*** Launching Shell-FM
    You may call `shellfm` function which will start Shell-FM
    subprocess and tune to default Last.fm radio provided you've
    specified one in `lastfm-default-url` customization variable.
*** Shell-FM functions
    Then you may see all the Shell-FM functions by typing `C-h a
    shellfm`.

    You may stop listening using `shellfm-pause` or `shellfm-stop`.
    Kill Shell-FM using `shellfm-kill` function.
*** Tips
    In case you have keyboard with additional multimedia keys, it may
    be cool to bind them all to `shellfm-` functions.

** Further information
   You may read an original emacs-shellfm announcement at
   http://sphinx.net.ru/blog/entry/emacs-shellfm/ (in Russian).

   Please report any bugs and issues related to emacs-shellfm to me
   via dima@sphinx.net.ru.

** Known issues
*** Login data
    Emacs-shellfm won't work correctly unless you set up your Last.fm
    login and password in `~/.shell-fm/shell-fm.rc`.
*** np-file-pormat
    Please note that emacs-shellfm may not work properly if you
    changed `np-file-format` option in your `shell-fm.rc` (so you may
    not see the track duration or remaining seconds of the played
    track).
